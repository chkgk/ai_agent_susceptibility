{{ block title }}
    Risk Preferences
{{ endblock }}

{{ block styles }}
<style>
    .left-border {
        border-left: 1px solid #000;
    }
</style>
{{ endblock }}

{{ block content }}

    <p>For each of the rows below, please choose whether you prefer to play the lottery or receive the sure amount.</p>

    <table class="table text-center">
        <thead>
            <tr>
                <th rowspan="2" style="border-bottom-color: #000;">Choose A</th>
                <th id="table-head-lottery-left">
                    <p>Lottery A</p>
                </th>
                <th id="table-head-lottery-right" class="left-border">
                    <p>Safe amount B</p>
                </th>
                <th rowspan="2" style="border-bottom-color: #000;">Choose B</th>
            </tr>
            <tr id="table-head-tr">

            </tr>
        </thead>
        <tbody id="table-body">
            
        </tbody>
    </table>

    {{ next_button }}

{{ endblock }}


{{ block scripts }}
<script>
       
    let table_body = document.getElementById('table-body');
    let table_head_tr = document.getElementById('table-head-tr');
        
    let table_head_lottery_left = document.getElementById('table-head-lottery-left');
    let table_head_lottery_right = document.getElementById('table-head-lottery-right');
    
    let lottery_left = js_vars.lotteries.lottery_a;
    let lottery_right = js_vars.lotteries.lottery_b;

    // replace error message
    let otree_form_errors = document.getElementsByClassName("otree-form-errors");
    if (otree_form_errors.length > 0) {
        otree_form_errors[0].innerText = "Bitte treffen Sie eine Entscheidung!";
    }
        
    table_head_lottery_left.colSpan = lottery_left.probabilities.length;
    table_head_lottery_right.colSpan = lottery_right.probabilities.length;
    
    let left_val_sum = 0;
    lottery_left.probabilities.forEach(probability => {
        let th = document.createElement('th');
        let val = probability * 100;
        left_val_sum += val;
        let span = document.createElement('span');
        span.innerText = `${val}%`;
        th.appendChild(span);
        table_head_tr.appendChild(th);
    }) 
    
    let c = 0;
    let right_val_sum = 0;
    lottery_right.probabilities.forEach(probability => {
        let th = document.createElement('th');
        if (c === 0) {
            th.className = 'left-border';
            c++;
        }
        let val = probability * 100;
        right_val_sum += val;
        let span = document.createElement('span');
        span.innerText = `${val}%`;
        th.appendChild(span);
        table_head_tr.appendChild(th);
    }) 
    
    for (let j = 0; j < lottery_left.prizes[0].length; j++) {
        let num = (j + 1).toString();
        let tr = document.createElement('tr');
        let td1 = document.createElement('td');
        let ip1 = document.createElement('input');
        ip1.type = 'radio';
        ip1.name = `hl_a_${num}`;
        ip1.id = `id_hl_a_${num}-0`;
        ip1.value = "True";
        ip1.required = true;
        td1.appendChild(ip1);
        tr.appendChild(td1);
              
        
        for (let k = 0; k < lottery_left.prizes.length; k++) {
            let td = document.createElement('td');
            let prize = lottery_left.prizes[k][j].toFixed(2);
            td.innerHTML = `${prize} €`;
            tr.appendChild(td);
        }
        let c = 0;
        for (let l = 0; l < lottery_right.prizes.length; l++) {
            let td = document.createElement('td');
            let prize = lottery_right.prizes[l][j].toFixed(2);
            td.innerHTML = `${prize} €`;
            if (c === 0) {
                td.className = 'left-border';
                c++;
            }
            tr.appendChild(td);
        }
        let td2 = document.createElement('td');
        let ip2 = document.createElement('input');
        ip2.type = 'radio';
        ip2.name = `hl_a_${num}`;
        ip2.id = `id_hl_a_${num}-1`;
        ip2.value = "False";
        ip2.required = true;
        td2.appendChild(ip2);
        tr.appendChild(td2);
        table_body.appendChild(tr);
    }
    

</script>
{{ endblock }}